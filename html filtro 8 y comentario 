Sub Generar_LINEASVCA()

    Dim wsC As Worksheet, wsT As Worksheet
    Dim tipo As String, cliente As String, release As String
    Dim filaNueva As Long, contador As Long
    Dim ultFila As Long, i As Long
    Dim valEnlace As String, valD As String, valF As String, valI As String
    
    '==== DATOS INICIALES ====
    tipo = InputBox("Introduce TIPO:", "TIPO", "10")
    cliente = InputBox("Introduce CLIENTE:", "CLIENTE")
    release = InputBox("Introduce RELEASE:", "RELEASE")
    If tipo = "" Or cliente = "" Or release = "" Then Exit Sub
    
    '==== HOJA ORIGEN ====
    Set wsC = Worksheets("Contabilidad_Cuentas")
    
    '==== CREAR HOJA NUEVA ====
    On Error Resume Next
    Application.DisplayAlerts = False
    Worksheets("LINEASVCA").Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    Set wsT = Worksheets.Add
    wsT.Name = "LINEASVCA"
    
    ' CABECERAS EXACTAS
    wsT.Range("A1:AX1").Value = Array( _
        "Tipo.", "Cliente", "Pac", "Release.", "Id.", "Cod.Tabla", "Linea", "Tip Lin", "COD.ENL.", "EM.DE.", _
        "HD.", "CTA.ENT.", "DE", "CTR.HA", "E.ID.", "COD.ART.", "C.ID.", "HC", "H.ID.", "ID.", _
        "D.M.H.", "R.D.", "R.H.", "CENT.COST.DE", "CENT.COST.HASTA", "COMP.DE", "ART.ID", "ART.HA", _
        "NUM.CUENTA", "VALOR.ESPE.", "VCON.NAT", "VCON.COP", "CON.NAT", "CON.C.OP", "RESERVADO")
    
    filaNueva = 2
    contador = 5
    
    '==== RECORRER CONTABILIDAD_CUENTAS ====
    ultFila = wsC.Cells(wsC.Rows.Count, "B").End(xlUp).Row
    
    For i = 1 To ultFila
        
        ' B contiene ENLACE CONTABLE (texto combinado)
        If Trim(wsC.Cells(i, "B").Value) <> "" Then
            
            ' mirar F y I (derecha 2 y derecha 4)
            valF = Trim(wsC.Cells(i, "F").Value)
            valI = Trim(wsC.Cells(i, "I").Value)
            
            ' SI alguna está informada → crear línea
            If valF <> "" Or valI <> "" Then
            
                wsT.Cells(filaNueva, "A") = tipo
                wsT.Cells(filaNueva, "B") = cliente
                wsT.Cells(filaNueva, "C") = "991" & cliente
                wsT.Cells(filaNueva, "D") = ""
                wsT.Cells(filaNueva, "E") = release
                
                ' F valores fijos
                wsT.Cells(filaNueva, "F") = ""
                wsT.Cells(filaNueva, "G") = ""
                
                ' CONTADOR: 5, 10, 15...
                wsT.Cells(filaNueva, "H") = contador
                contador = contador + 5
                
                ' I = 0 siempre
                wsT.Cells(filaNueva, "I") = 0
                
                ' Valores fijos indicados en texto
                wsT.Cells(filaNueva, "J") = 999
                wsT.Cells(filaNueva, "N") = 9
                wsT.Cells(filaNueva, "AA") = 9
                
                ' AB ← si D e I están informadas, PRIORIDAD I
                valD = Trim(wsC.Cells(i, "D").Value)
                
                If valI <> "" Then
                    wsT.Cells(filaNueva, "AB") = valI
                ElseIf valD <> "" Then
                    wsT.Cells(filaNueva, "AB") = valD
                End If
                
                ' AG ← columna E de Contabilidad_Cuentas
                wsT.Cells(filaNueva, "AG") = wsC.Cells(i, "E").Value
                
                filaNueva = filaNueva + 1
            
            End If
        End If
    Next i
    
    MsgBox "Proceso completado. Líneas generadas: " & filaNueva - 2, vbInformation

End Sub