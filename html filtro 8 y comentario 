Option Explicit

Dim fso, carpeta, archivo, texto, inicio, comentario, salida
Dim ruta, rutaSalida, total

ruta = "."
rutaSalida = "comentarios_total.txt"

Set fso = CreateObject("Scripting.FileSystemObject")
Set carpeta = fso.GetFolder(ruta)
Set salida = fso.CreateTextFile(rutaSalida, True, True)

total = 0

For Each archivo In carpeta.Files
    If LCase(fso.GetExtensionName(archivo.Name)) = "htm" Then
        texto = fso.OpenTextFile(archivo.Path, 1, False).ReadAll

        inicio = InStr(1, texto, "Comentarios a las tablas del VR", vbTextCompare)
        If inicio > 0 Then
            comentario = Mid(texto, inicio)
            salida.WriteLine String(80, "-")
            salida.WriteLine archivo.Name
            salida.WriteLine comentario
            salida.WriteLine vbCrLf
            total = total + 1
        End If
    End If
Next

salida.Close

MsgBox "Se han extra√≠do " & total & " comentarios en " & rutaSalida