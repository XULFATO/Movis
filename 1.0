MÉTODO 1: Cambio de DPB a DPx (Clásico)
Copia de seguridad del archivo .xlsm
Renombra de .xlsm a .zip
Extrae TODO el contenido del ZIP a una carpeta
Ve a la carpeta xl
Busca el archivo vbaProject.bin
Abre vbaProject.bin con Notepad++ o UltraEdit (modo texto)
Busca (Ctrl+F) la cadena: DPB=
Cambia DPB= por DPx= (solo la B por x)
Guarda el archivo
Selecciona TODO el contenido de la carpeta extraída (NO la carpeta, sino lo que está DENTRO: [Content_Types].xml, carpeta _rels, carpeta xl, etc.)
Click derecho → Enviar a → Carpeta comprimida (o comprimir con 7-Zip/WinRAR)
Renombra el nuevo .zip a .xlsm
Abre en Excel
Si te dice que está corrupto, ve al editor VBA (Alt+F11) y te pedirá nueva contraseña
MÉTODO 2: Cambio de CMG a CMx
Copia de seguridad del archivo .xlsm
Renombra de .xlsm a .zip
Extrae TODO el contenido
Ve a xl → vbaProject.bin
Abre con Notepad++ o UltraEdit
Busca: CMG=
Cambia CMG= por CMx=
Guarda
Selecciona TODO el contenido extraído (archivos y carpetas internas)
Comprimir a ZIP
Renombrar a .xlsm
Abrir en Excel
MÉTODO 3: Eliminación completa de líneas de protección
Copia de seguridad
Renombrar a .zip y extraer
Abrir xl/vbaProject.bin con UltraEdit o Notepad++
Buscar y ELIMINAR COMPLETAMENTE estas líneas (toda la línea entera):
Línea que empiece con CMG=
Línea que empiece con DPB=
Línea que empiece con GC= (si existe)
Guardar el archivo
Comprimir TODO el contenido
Renombrar a .xlsm
Abrir en Excel
MÉTODO 4: Edición hexadecimal precisa (UltraEdit)
Copia de seguridad
Renombrar a .zip y extraer
Abrir vbaProject.bin con UltraEdit
Ir a View → Hex Edit (o Ctrl+H)
Buscar en HEX: 44 50 42 3D (esto es "DPB=" en hexadecimal)
Cambiar el byte 42 por 78 (queda: 44 50 78 3D)
Guardar
Comprimir contenido
Renombrar a .xlsm
Abrir
MÉTODO 5: Desde VBA con nuevo módulo
Abre tu archivo .xlsm protegido en Excel normalmente
Alt+F11 (abrir editor VBA)
Insert → Module (insertar nuevo módulo - esto SÍ debería dejarte)
Pega este código:
Sub RemoverProteccion()
    Dim wbPath As String
    Dim fso As Object
    Dim tempPath As String
    
    wbPath = ThisWorkbook.FullName
    
    ' Guardar y cerrar
    ThisWorkbook.Save
    Application.DisplayAlerts = False
    ThisWorkbook.Saved = True
    
    MsgBox "Ahora cierra Excel completamente y vuelve a abrir el archivo"
End Sub
Ejecuta la macro
Cierra Excel
Vuelve a abrir el archivo
MÉTODO 6: Exportar módulos uno por uno (si puedes ver nombres)
Abre el archivo
Alt+F11
En el explorador de proyectos (izquierda), ¿ves los nombres de módulos/formularios aunque no puedas abrirlos?
Si SÍ, anota todos los nombres
Crea un NUEVO archivo Excel
Alt+F11 en el nuevo archivo
Tools → References → marca las mismas referencias que tenías
Ahora tendrás que recrear el código (sé que no es ideal, pero es un plan B)
MÉTODO 7: VBA con acceso programático habilitado
PRIMERO: Archivo → Opciones → Centro de confianza → Configuración del Centro de confianza → Configuración de macros
Marca: "Confiar en el acceso al modelo de objetos de proyectos de VBA"
Crea un NUEVO archivo Excel
Alt+F11
Insert → Module
Pega:
Sub DesbloquearVBA()
    Dim wbProtegido As Workbook
    Dim archivoPath As String
    
    ' Cambia esta ruta por la de tu archivo
    archivoPath = "C:\ruta\a\tu\archivo.xlsm"
    
    Set wbProtegido = Workbooks.Open(archivoPath)
    
    On Error Resume Next
    wbProtegido.VBProject.VBComponents("Module1").CodeModule.DeleteLines 1, 1
    On Error GoTo 0
    
    wbProtegido.Close SaveChanges:=True
    
    MsgBox "Completado"
End Sub
Modifica la ruta del archivo
Ejecuta la macro
MÉTODO 8: Crear nuevo proyecto VBA limpio
Renombrar .xlsm a .zip y extraer
Ir a xl
RENOMBRAR vbaProject.bin a vbaProject.bin.OLD
Abrir el Excel original en otra ventana
Alt+F11 → Insertar módulo vacío
Guardar como nuevo archivo .xlsm
Cerrar Excel
Extraer ESTE nuevo archivo también
Copiar el vbaProject.bin del archivo NUEVO
Pegarlo en la carpeta xl del archivo VIEJO (sobrescribiendo)
Comprimir y renombrar a .xlsm
Abrir (ahora tendrás acceso pero SIN código - tendrás que importar desde el .OLD)
