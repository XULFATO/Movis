Sub Extractor_Ultra_Nitidez()
    Dim vbc As Object, codLimpio As String, lin As String, i As Long
    Dim r As Long, tamBloque As Integer: tamBloque = 65 ' Menos caracteres = letras más grandes
    
    ' 1. MINIFICACIÓN (Elimina el 60% del peso)
    For Each vbc In ThisWorkbook.VBProject.VBComponents
        codLimpio = codLimpio & "[[MOD:" & vbc.Name & "]]"
        On Error Resume Next
        With vbc.CodeModule
            For i = 1 To .CountOfLines
                lin = Trim(.Lines(i, 1))
                If lin <> "" And Left(lin, 1) <> "'" Then
                    Do While InStr(lin, "  ") > 0: lin = Replace(lin, "  ", " "): Loop
                    codLimpio = codLimpio & lin & "¶"
                End If
            Next i
        End With
        On Error GoTo 0
    Next vbc

    ' 2. CREACIÓN DE TABLA DE ALTA VISIBILIDAD
    Dim ws As Worksheet: Set ws = Sheets.Add: ws.Name = "CAPTURA"
    ws.Cells(1, 1) = "ID": ws.Cells(1, 2) = "DATA"
    
    r = 2
    For i = 1 To Len(codLimpio) Step tamBloque
        ws.Cells(r, 1).Value = r - 1
        ws.Cells(r, 2).Value = "'" & Mid(codLimpio, i, tamBloque)
        r = r + 1
    Next i
    
    ' 3. FORMATO "ANTIFALLOS" (Letra gigante y bordes)
    With ws.Range("A1:B" & r)
        .Font.Name = "Consolas"
        .Font.Size = 16 ' IMPORTANTE: Letra grande para que el móvil no falle
        .Borders.LineStyle = xlContinuous
        .Borders.Weight = xlThin
        .Columns(1).AutoFit
        .Columns(2).ColumnWidth = 85
    End With
    
    Application.DisplayFullScreen = True
    MsgBox "Toma fotos por bloques de 20-30 filas. Asegúrate de que no haya reflejos."
End Sub
