Sub ComprimirDatos()
    Dim dict As Object, ws As Worksheet
    Dim lastRow As Long, i As Long, col As Long
    Dim cell As String, key As String
    
    Set dict = CreateObject("Scripting.Dictionary")
    Set ws = ActiveSheet
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    
    ' Generar diccionario automático
    For col = 1 To 7 ' Columnas A-G
        For i = 2 To lastRow
            cell = ws.Cells(i, col).Value
            If Len(cell) > 10 And Not dict.exists(cell) Then
                key = Left(cell, 2) & Right(cell, 2) ' Primeras+últimas 2
                dict(cell) = key
            End If
        Next
    Next
    
    ' Reemplazar en hoja
    For col = 1 To 7
        For i = 2 To lastRow
            cell = ws.Cells(i, col).Value
            If dict.exists(cell) Then
                ws.Cells(i, col).Value = dict(cell)
            End If
        Next
    Next
    
    ' Imprimir diccionario para JavaScript
    Debug.Print "const DICT = {"
    For Each cell In dict.Keys
        Debug.Print "  """ & dict(cell) & """: """ & cell & ""","
    Next
    Debug.Print "};"
End Sub
