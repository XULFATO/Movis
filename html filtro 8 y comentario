Sub ValidarCombinaciones(celdaInicio As Range)

    Dim ws As Worksheet
    Set ws = celdaInicio.Worksheet
    
    Dim fila As Long
    Dim colBase As Long
    Dim ultimaFila As Long
    
    colBase = celdaInicio.Column
    fila = celdaInicio.Row
    ultimaFila = ws.Cells(ws.Rows.Count, colBase).End(xlUp).Row
    
    Dim dict As Object
    Set dict = CreateObject("Scripting.Dictionary")
    
    Dim clave As String
    Dim comboActual As String
    Dim comboGuardado As String
    
    For fila = celdaInicio.Row To ultimaFila
        
        clave = Trim(ws.Cells(fila, colBase).Value)
        comboActual = Trim(ws.Cells(fila, colBase + 1).Value) & "|" & _
                       Trim(ws.Cells(fila, colBase + 2).Value)
        
        If clave <> "" Then
            If Not dict.Exists(clave) Then
                ' Primera vez que aparece la clave
                dict.Add clave, comboActual
            Else
                comboGuardado = dict(clave)
                
                If comboActual <> comboGuardado Then
                    ' MARCAR ERROR (ejemplo: color rojo)
                    ws.Rows(fila).Interior.Color = RGB(255, 180, 180)
                End If
            End If
        End If
    Next fila
    
    MsgBox "Validaci√≥n terminada", vbInformation

End Sub
